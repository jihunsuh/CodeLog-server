!function(e,s){for(var t in s)e[t]=s[t]}(exports,function(e){var s={};function t(a){if(s[a])return s[a].exports;var n=s[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=s,t.d=function(e,s,a){t.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,s){if(1&s&&(e=t(e)),8&s)return e;if(4&s&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var n in e)t.d(a,n,function(s){return e[s]}.bind(null,n));return a},t.n=function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(s,"a",s),s},t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},t.p="",t(t.s=11)}([function(e,s){e.exports=require("express-async-handler")},function(e,s,t){"use strict";e.exports={userService:t(7),postingService:t(10),companyService:t(34)}},function(e,s,t){"use strict";e.exports={handlePromise:async e=>{try{const s=await e;return"string"==typeof s?s:null===s?null:Array.isArray(s)?s.map(e=>e.dataValues):s.dataValues}catch(e){return console.log(e),null}},handlePostData:e=>{e.theme=e.Type.name,delete e.Type;let s={};for(let t of e.Contents)s[t.Subtitle.name]=t.body;e.content=s,delete e.Contents;let t=[];for(let s of e.postings_tags)t.push(s.Tag.name);return e.selected_tags=t,delete e.postings_tags,e},handlePostDatas:e=>e.map(e=>{e.theme=e.Type.name,delete e.Type;let s={};for(let t of e.Contents)s[t.Subtitle.name]=t.body;e.content=s,delete e.Contents;let t=[];for(let s of e.postings_tags)t.push(s.Tag.name);return e.selected_tags=t,delete e.postings_tags,e}),handleCompanyData:e=>{let s=[];for(let t of e.companies_tags)s.push(t.Tag.name);return e.company_tags=s,delete e.companies_tags,e},handleCompanyDatas:e=>e.map(e=>{let s=[];for(let t of e.companies_tags)s.push(t.Tag.name);return e.company_tags=s,delete e.companies_tags,e}),handleTagDatas:e=>{let s={};return e.map(e=>{e.Tag.dataValues.postings_tags.map(e=>{e.Posting.user_id in s?s[e.Posting.user_id]++:s[e.Posting.user_id]=1})}),Object.entries(s).sort((e,s)=>s[1]-e[1])}}},function(e,s,t){"use strict";(function(s,a){const n=t(24),o=t(25),i=t(9),d=o.basename(s);console.log(a);const r=t(26).production,u={};let c;c=r.use_env_variable?new i(process.env[r.use_env_variable],r):new i(r.database,r.username,r.password,r),console.log("dirname",a),n.readdirSync(a).filter(e=>(console.log("file file file",e),0!==e.indexOf(".")&&e!==d&&".js"===e.slice(-3))).forEach(e=>{console.log("forEach file file",e),console.log("path",o),console.log("path path dirname file",o.join(e));const s=c.import(o.join("./",e));console.log("name name name",s.name),u[s.name]=s}),Object.keys(u).forEach(e=>{u[e].associate&&u[e].associate(u)}),u.sequelize=c,u.Sequelize=i,e.exports=u}).call(this,"/index.js","database/models")},function(e,s,t){"use strict";const a=t(23);e.exports={tokenGenerator:e=>new Promise((s,t)=>{a.sign(e,"secret",{algorithm:"HS256",expiresIn:"1d"},(function(e,t){if(e)throw e;s(t)}))}),isValid:e=>new Promise((s,t)=>{a.verify(e,"secret",(t,a)=>{if(t)s({isValid:!1});else{const t=new Date(1e3*a.exp),n=new Date;s(t<n?{isValid:!1}:{isValid:!0,token:e,userData:a})}})})}},function(e,s,t){"use strict";e.exports={companies:t(27),postings:t(28),users:t(8),subtitles:t(29),contents:t(30),types:t(31),tags:t(32),companies_tags:t(33)}},function(e,s){e.exports=require("express")},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(8),{isValid:n}=t(4),o=t(10),i={signin:async(e,s)=>{let t;return t=await a.findByEmail(e),t||(t=await a.findByUsername(e)),t?t.password!==s?{success:!1,payload:null,message:"wrong password"}:{success:!0,payload:t,message:"found user"}:{success:!1,payload:null,message:"unvalid user"}},signup:async e=>{const s=await a.create(e);return"duplicated"===s?{success:!1,payload:null,message:"duplicated"}:"created"===s?{success:!0,payload:null,message:"created"}:{success:!1,payload:null,message:String(s)}},update:async e=>{const s=await a.updateByEmail(e);return s?{success:!0,payload:s,message:"successfully update user"}:{success:!1,payload:null,message:"can't update user"}},updatebyId:async e=>{const s=await a.updateById(e);return s?{success:!0,payload:s,message:"successfully update user"}:{success:!1,payload:null,message:"can't update user"}},findByToken:async e=>{const s=await n(e);if(!s.isValid)return{success:!1,payload:null,message:"login required"};const{email:t,password:o}=s.userData,i=await a.findByEmail(t);return i?i.password!==o?{success:!1,payload:null,message:"wrong password"}:{success:!0,payload:i,message:"id found"}:{success:!1,payload:null,message:"unvalid user"}},checkEmail:async e=>await a.findByEmail(e)?{success:!1,payload:null,message:"duplicated"}:{success:!0,payload:null,message:"not duplicated"},delete:async e=>{const s=await o.findByUser(e);if(!s.success)return{success:!1,payload:null,message:"can't find posts"};for(let e of s.payload){if(!(await o.delete(e.id)).success)return{success:!1,payload:null,message:"can't delete post"}}await a.delete(e);return{success:!0,payload:null,message:"deleted"}}};e.exports=i},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const{Users:a}=t(3),{handlePromise:n}=t(2);e.exports={create:e=>n(a.findOrCreate({where:{email:e.email},defaults:e}).spread((e,s)=>s?"created":"duplicated")),findByEmail:e=>n(a.findOne({where:{email:e}})),findByUsername:e=>n(a.findOne({where:{username:e}})),findByCompany:e=>n(a.findAll({where:{company_id:e}})),findById:e=>n(a.findOne({where:{id:e}})),updateByEmail:e=>n(a.update(e,{where:{email:e.email}})),updateById:e=>n(a.update(e,{where:{id:e.id}})),delete:e=>n(a.destroy({where:{id:e}}))}},function(e,s){e.exports=require("sequelize")},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const{users:a,companies:n,postings:o,types:i,subtitles:d,contents:r,tags:u}=t(5),{handlePostData:c,handlePostDatas:l,handleCompanyDatas:p}=t(2),y={create:async e=>{const s=await i.findByName(e.theme);if(!s)return{success:!1,payload:null,message:"can't find theme"};e.type_id=s.id;const t=await o.create(e);if(!t)return{success:!1,payload:null,message:"error occurred"};const a=t.id,n=await d.findByTypeid(s.id);for(let s of n){const{name:t,id:n}=s,i=e.content[t];if(!await r.create(a,n,i)){return await o.delete(a)?{success:!1,payload:null,message:"can't create content"}:{success:!1,payload:null,message:"can't create content, can't delete post"}}}return{success:!0,payload:t,message:"created"}},find:async e=>{let s=await o.findById(e);if(!s)return{success:!1,payload:null,message:"can't find post"};let t=c(s);const n=await a.findById(t.user_id);return n&&(t.user={email:n.email,username:n.username,position:n.position,certificate:n.certificate}),{success:!0,payload:t,message:"successfully found"}},getHome:async()=>{let e={},s=await o.findByNew(10);if(!s)return{success:!1,payload:null,message:"can't find new posts"};e.new_post=l(s);let t=await o.findByManyLike(10);if(!t)return{success:!1,payload:null,message:"can't find recommended posts"};e.recommended_post=l(t);let a=await n.findByNew(10);return a?(e.new_companies=p(a),{success:!0,payload:e,message:"success"}):{success:!1,payload:null,message:"can't find companies"}},findBlog:async e=>{let s={};const t=await i.findAll();if(!t)return{success:!1,payload:null,message:"can't find types"};for(let a of t){let t=await o.findByUserTheme(e,a.id);if(!t)return{success:!1,payload:null,message:"can't find post"};s[a.name+"_posts"]=l(t)}return{success:!0,payload:s,message:"all posts found"}},findByUser:async e=>{let s=await o.findByUser(e);return s?{success:!0,payload:s,message:"all posts found"}:{success:!1,payload:null,message:"can't find post"}},addTags:async(e,s)=>{let t=[];for(let a of s){const s=await u.findByName(a);if(!s)return{success:!1,payload:null,message:"can't find tag"};t.push({post_id:e,tag_id:s.id})}return await u.addPTTags(t)?{success:!0,payload:null,message:"successfully taged"}:{success:!1,payload:null,message:"can't put tags in"}},like:async e=>{const s=await o.increaseLike(e);return s?{success:!0,payload:s,message:"post liked"}:{success:!1,payload:null,message:"There's an error while like"}},unlike:async e=>{const s=await o.decreaseLike(e);return s?{success:!0,payload:s,message:"post unliked"}:{success:!1,payload:null,message:"There's an error while undo like"}},update:async(e,s)=>{const{id:t,title:a,content:n}=s,i=await o.findById(t);if(!i)return{success:!1,payload:null,message:"can't find post"};if(i.user_id!==e)return{success:!1,payload:null,message:"it is not your post"};const d=await r.findByPostId(t);if(!d)return{success:!1,payload:null,message:"can't find content"};for(let e of d)if(e.Subtitle.name in n){if(e.body=n[e.Subtitle.name],!await r.update(e))return{success:!1,payload:null,message:"fail to update"}}await u.deleteByPostId(t);return await o.updateTitleById(t,a)?{success:!0,payload:null,message:"post updated"}:{success:!1,payload:null,message:"fail to update title"}},delete:async e=>{await u.deleteByPostId(e),await r.deleteByPostId(e);return{success:!0,payload:await o.delete(e),message:"deleted"}},test:async e=>({success:!0,payload:await r.findByPostId(e),message:"deleted"})};e.exports=y},function(e,s,t){"use strict";const a=t(6),n=t(12),o=t(13),i=t(16),d=t(17),r=t(18),u=t(19),c=a();c.use(i({secret:"@warrmansion",resave:!1,saveUninitialized:!0})),c.use(d()),c.use(n.json()),c.use(n.urlencoded({extended:!1})),c.use(o({origin:["http://localhost:3000"],methods:["GET","POST"],credentials:!0})),c.use(r("dev")),c.use("/",u),c.set("port",3001),c.listen(c.get("port"),()=>{console.log(`app is listening in PORT ${c.get("port")}`)}),e.exports=c},function(e,s){e.exports=require("body-parser")},function(e,s,t){!function(){"use strict";var s=t(14),a=t(15),n={origin:"*",methods:"GET,HEAD,PUT,PATCH,POST,DELETE",preflightContinue:!1,optionsSuccessStatus:204};function o(e){return"string"==typeof e||e instanceof String}function i(e,s){var t,a=s.headers.origin,n=[];return e.origin&&"*"!==e.origin?o(e.origin)?(n.push([{key:"Access-Control-Allow-Origin",value:e.origin}]),n.push([{key:"Vary",value:"Origin"}])):(t=function e(s,t){if(Array.isArray(t)){for(var a=0;a<t.length;++a)if(e(s,t[a]))return!0;return!1}return o(t)?s===t:t instanceof RegExp?t.test(s):!!t}(a,e.origin),n.push([{key:"Access-Control-Allow-Origin",value:!!t&&a}]),n.push([{key:"Vary",value:"Origin"}])):n.push([{key:"Access-Control-Allow-Origin",value:"*"}]),n}function d(e){return!0===e.credentials?{key:"Access-Control-Allow-Credentials",value:"true"}:null}function r(e){var s=e.exposedHeaders;return s?(s.join&&(s=s.join(",")),s&&s.length?{key:"Access-Control-Expose-Headers",value:s}:null):null}function u(e,s){for(var t=0,n=e.length;t<n;t++){var o=e[t];o&&(Array.isArray(o)?u(o,s):"Vary"===o.key&&o.value?a(s,o.value):o.value&&s.setHeader(o.key,o.value))}}e.exports=function(e){var t=null;return t="function"==typeof e?e:function(s,t){t(null,e)},function(e,a,o){t(e,(function(t,c){if(t)o(t);else{var l=s({},n,c),p=null;l.origin&&"function"==typeof l.origin?p=l.origin:l.origin&&(p=function(e,s){s(null,l.origin)}),p?p(e.headers.origin,(function(s,t){s||!t?o(s):(l.origin=t,function(e,s,t,a){var n=[];"OPTIONS"===(s.method&&s.method.toUpperCase&&s.method.toUpperCase())?(n.push(i(e,s)),n.push(d(e)),n.push(function(e){var s=e.methods;return s.join&&(s=e.methods.join(",")),{key:"Access-Control-Allow-Methods",value:s}}(e)),n.push(function(e,s){var t=e.allowedHeaders||e.headers,a=[];return t?t.join&&(t=t.join(",")):(t=s.headers["access-control-request-headers"],a.push([{key:"Vary",value:"Access-Control-Request-Headers"}])),t&&t.length&&a.push([{key:"Access-Control-Allow-Headers",value:t}]),a}(e,s)),n.push(function(e){var s=("number"==typeof e.maxAge||e.maxAge)&&e.maxAge.toString();return s&&s.length?{key:"Access-Control-Max-Age",value:s}:null}(e)),n.push(r(e)),u(n,t),e.preflightContinue?a():(t.statusCode=e.optionsSuccessStatus,t.setHeader("Content-Length","0"),t.end())):(n.push(i(e,s)),n.push(d(e)),n.push(r(e)),u(n,t),a())}(l,e,a,o))})):o()}}))}}}()},function(e,s){e.exports=require("object-assign")},function(e,s){e.exports=require("vary")},function(e,s){e.exports=require("express-session")},function(e,s){e.exports=require("cookie-parser")},function(e,s){e.exports=require("morgan")},function(e,s,t){"use strict";var a=t(6).Router();const{authController:n,postController:o,blogController:i,mypageController:d,companyController:r,tagController:u,homeController:c,verify:l}=t(20);a.post("/signup",n.signup.post),a.post("/signup/company",n.csignup.post),a.post("/signin",n.signin.post),a.post("/signin/company",n.csignin.post),a.post("/signout",n.signout.post),a.post("/duplicate",n.duplicate.post),a.get("/mypage",d.get),a.put("/mypage",d.put),a.post("/mypage/update",d.put),a.get("/company",r.get),a.put("/company",r.put),a.post("/company/update",r.put),a.post("/company/member/update",r.member.put),a.post("/company/member/delete",r.member.delete),a.post("/company/member/delete/:id",r.memberbyid.delete),a.post("/post",o.board.post),a.post("/test",o.board.test),a.get("/post",o.board.get),a.put("/post",o.board.put),a.delete("/post",o.board.delete),a.post("/post/update",o.board.put),a.post("/post/delete",o.board.delete),a.post("/post/delete/:id",o.boardbyid.delete),a.get("/post/:id",o.boardbyid.get),a.delete("/post/:id",o.boardbyid.delete),a.post("/post/like",o.like.post),a.post("/post/like/:id",o.likebyid.post),a.post("/post/dislike",o.like.delete),a.post("/post/dislike/:id",o.likebyid.delete),a.delete("/post/like",o.like.delete),a.delete("/post/like/:id",o.likebyid.delete),a.get("/blog",i.main.get),a.get("/tags",u.get),a.get("/home",c.get),a.get("/auth",l.get),a.post("/auth",l.post),e.exports=a},function(e,s,t){"use strict";e.exports={authController:t(21),postController:t(40),blogController:t(45),mypageController:t(47),companyController:t(48),tagController:t(51),homeController:t(52),verify:t(53)}},function(e,s,t){"use strict";e.exports={signin:t(22),signout:t(35),signup:t(36),duplicate:t(37),csignup:t(38),csignin:t(39)}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{tokenGenerator:n}=t(4),{userService:o}=t(1);e.exports={post:a(async(e,s)=>{const{email:t,username:a,password:i}=e.body,d=t||a,r=await o.signin(d,i);if(!r.success)return void s.status(404).send(`User with ${d} doesn't exist`);if(!r.payload)return void s.status(403).send("wrong password");const u=await n({email:r.payload.email,password:r.payload.password,user_type:"developer"});let c={message:"Token generated"};r.payload.company_id&&(c.isCompanyUser=!0),s.cookie("token",u).status(200).send(c)})}},function(e,s){e.exports=require("jsonwebtoken")},function(e,s){e.exports=require("fs")},function(e,s){e.exports=require("path")},function(e){e.exports=JSON.parse('{"development":{"username":"root","password":"applepie","database":"codelog","host":"codelog-database-build.cibnhzur2wz1.ap-northeast-2.rds.amazonaws.com","port":3306,"dialect":"mysql","operatorsAliases":false},"test":{"username":"root","password":"applepie","database":"codelog","host":"codelog-database-build.cibnhzur2wz1.ap-northeast-2.rds.amazonaws.com","port":3306,"dialect":"mysql","operatorsAliases":false},"production":{"username":"root","password":"applepie","database":"codelog","host":"codelog-database-build.cibnhzur2wz1.ap-northeast-2.rds.amazonaws.com","port":3306,"dialect":"mysql","operatorsAliases":false}}')},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const{Companies:a,Users:n,companies_tags:o,Tags:i}=t(3),{handlePromise:d}=(t(3),t(2));a.hasMany(n,{foreignKey:"company_id"}),n.belongsTo(a,{foreignKey:"company_id"}),a.hasMany(o,{foreignKey:"company_id"}),o.belongsTo(a,{foreignKey:"company_id"}),i.hasMany(o,{foreignKey:"tag_id"}),o.belongsTo(i,{foreignKey:"tag_id"}),e.exports={create:e=>d(a.create(e)),find:e=>d(a.findOne({where:{id:e},order:[[o,"tag_id","ASC"]],include:[{model:n,attributes:["id","email","username","password","position"]},{model:o,attributes:["tag_id"],include:{model:i,attributes:["name"]}}]})),findByNew:e=>d(a.findAll({limit:e,order:[["id","DESC"],[o,"tag_id","ASC"]],attributes:["company_name","info","partner","company_homepage"],include:{model:o,attributes:["tag_id"],include:{model:i,attributes:["name"]}}})),update:e=>d(a.update(e,{where:{id:e.id}})),delete:e=>d(a.destroy({where:{id:e}}))}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const{Postings:a,postings_tags:n,Tags:o,Contents:i,Subtitles:d,Types:r}=t(3),{handlePromise:u}=t(2),c=t(9);c.Op;a.hasMany(i,{foreignKey:"post_id"}),i.belongsTo(a,{foreignKey:"post_id"}),r.hasMany(a,{foreignKey:"type_id"}),a.belongsTo(r,{foreignKey:"type_id"}),d.hasMany(i,{foreignKey:"subtitle_id"}),i.belongsTo(d,{foreignKey:"subtitle_id"}),a.hasMany(n,{foreignKey:"post_id"}),n.belongsTo(a,{foreignKey:"post_id"}),o.hasMany(n,{foreignKey:"tag_id"}),n.belongsTo(o,{foreignKey:"tag_id"}),e.exports={create:e=>u(a.create(e)),findById:e=>u(a.findOne({where:{id:e},order:[[n,"tag_id","ASC"]],attributes:{exclude:["type_id"]},include:[{model:r,attributes:["name"]},{model:i,attributes:["body","subtitle_id"],include:{model:d,attributes:["name"]}},{model:n,attributes:["tag_id"],include:{model:o,where:{type:"stack"},attributes:["name"]}}]})),findByUser:e=>u(a.findAll({where:{user_id:e},order:[["id","DESC"],[n,"tag_id","ASC"]],attributes:{exclude:["type_id","user_id"]},include:[{model:r,attributes:["name"]},{model:i,attributes:["body","subtitle_id"],include:{model:d,attributes:["name"]}},{model:n,attributes:["tag_id"],include:{model:o,where:{type:"stack"},attributes:["name"]}}]})),findByUserTheme:(e,s)=>u(a.findAll({where:{user_id:e,type_id:s},order:[["id","DESC"],[n,"tag_id","ASC"]],attributes:{exclude:["type_id","user_id"]},include:[{model:r,attributes:["name"]},{model:i,attributes:["body","subtitle_id"],include:{model:d,attributes:["name"]}},{model:n,attributes:["tag_id"],include:{model:o,where:{type:"stack"},attributes:["name"]}}]})),findByNew:e=>u(a.findAll({limit:e,order:[["id","DESC"],[n,"tag_id","ASC"]],attributes:{exclude:["type_id","user_id"]},include:[{model:r,attributes:["name"]},{model:i,attributes:["body","subtitle_id"],include:{model:d,attributes:["name"]}},{model:n,attributes:["tag_id"],include:{model:o,where:{type:"stack"},attributes:["name"]}}]})),findByManyLike:e=>u(a.findAll({limit:e,order:c.literal("likes DESC"),include:[{model:r,attributes:["name"]},{model:i,attributes:["body","subtitle_id"],include:{model:d,attributes:["name"]}},{model:n,attributes:["tag_id"],include:{model:o,where:{type:"stack"},attributes:["name"]}}]})),updateTitleById:(e,s)=>u(a.update({title:s},{where:{id:e}})),delete:e=>u(a.destroy({where:{id:e}})),increaseLike:e=>u(a.update({likes:c.literal("likes + 1")},{where:{id:e}})),decreaseLike:e=>u(a.update({likes:c.literal("likes - 1")},{where:{id:e}}))}},function(e,s,t){"use strict";const{Subtitles:a}=t(3),{handlePromise:n}=t(2);e.exports={findByTypeid:e=>n(a.findAll({where:{type_id:e}})),getAllSubts:()=>{}}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const{Contents:a,Subtitles:n}=t(3),{handlePromise:o}=t(2);n.hasMany(a,{foreignKey:"subtitle_id"}),a.belongsTo(n,{foreignKey:"subtitle_id"}),e.exports={create:(e,s,t)=>o(a.create({post_id:e,subtitle_id:s,body:t})),findByPostId:e=>o(a.findAll({where:{post_id:e},include:{model:n,attributes:["name"]}})),update:e=>o(a.update(e,{where:{id:e.id}})),updateMany:e=>o(a.bulkCreate(e,{updateOnDuplicate:["post_id","subtitle_id"],fields:["id","post_id","subtitle_id","body"]})),deleteByPostId:e=>o(a.destroy({where:{post_id:e}}))}},function(e,s,t){"use strict";const{Types:a}=t(3),{handlePromise:n}=t(2);e.exports={findByName:e=>n(a.findOne({where:{name:e}})),findById:e=>n(a.findOne({where:{id:e}})),findAll:()=>n(a.findAll())}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const{Tags:a,postings_tags:n,companies_tags:o}=t(3),{handlePromise:i}=t(2);e.exports={getPTTags:()=>i(a.findAll({where:{type:"stack"}})),getCTTags:()=>i(a.findAll({where:{type:"company"}})),findByName:e=>i(a.findOne({where:{name:e}})),deleteByPostId:e=>i(n.destroy({where:{post_id:e}})),deleteByCompanyId:e=>i(o.destroy({where:{company_id:e}})),addPTTags:e=>i(n.bulkCreate(e)),addCTTags:e=>i(o.bulkCreate(e))}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const{companies_tags:a,Tags:n,postings_tags:o,Postings:i,Users:d}=t(3),{handlePromise:r}=t(2);n.hasMany(a,{foreignKey:"tag_id"}),a.belongsTo(n,{foreignKey:"tag_id"}),n.hasMany(o,{foreignKey:"tag_id"}),o.belongsTo(n,{foreignKey:"tag_id"}),i.hasMany(o,{foreignKey:"post_id"}),o.belongsTo(i,{foreignKey:"post_id"}),d.hasMany(i,{foreignKey:"user_id"}),i.belongsTo(d,{foreignKey:"user_id"}),e.exports={findDeveloper:e=>r(a.findAll({where:{company_id:e},attributes:["tag_id"],order:[["tag_id","ASC"],[n,o,i,"user_id","ASC"]],include:{model:n,attributes:["name"],include:{model:o,attributes:["post_id"],include:{model:i,attributes:["user_id"]}}}}))}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const{companies_tags:a,users:n,companies:o,tags:i}=t(5),{handleCompanyData:d,handleTagDatas:r}=t(2),u=t(7),c={signin:async(e,s,t)=>{const a=await u.signin(s,t);if(!a.success)return{success:!1,payload:null,message:a.message};let n=a.payload.company_id;if(!n)return{success:!1,payload:null,message:"you don't have company"};return(await o.find(n)).company_code!==e?{success:!1,payload:null,message:"wrong code"}:{success:!0,payload:a.payload,message:"found user"}},signup:async e=>{const s=await o.create(e);if(!s)return{success:!1,payload:null,message:"duplicated"};let t=e.member;if(t?t.company_id=s.id||null:t={email:"",username:"admin",password:s.company_code,company_id:s.id||null,position:"",certificate:"",personal_homepage:""},!(await u.signup(t)).success){return o.delete(s.id)?{success:!1,payload:null,message:"wrong member info"}:{success:!0,payload:null,message:"can't join member"}}return{success:!0,payload:s,message:"successfully created"}},find:async e=>{const s=await o.find(e);return s?{success:!0,payload:d(s),message:"successfully found"}:{success:!1,payload:null,message:"can't find company"}},update:async e=>{const s=await o.find(e.id);if(!s)return{success:!1,payload:null,message:"can't find company"};const{company_code:t,partner:a}=e;if((t||a)&&(s.company_code!==t||s.partner!==a))return{success:!1,payload:null,message:"can't update code or partner"};const n=await o.update(e);if(!n)return{success:!1,payload:null,message:"can't update company"};await i.deleteByCompanyId(e.id);return{success:!0,payload:n,message:"successfully update company"}},addTags:async(e,s)=>{let t=[];for(let a of s){const s=await i.findByName(a);if(!s)return{success:!1,payload:null,message:"can't find tag"};t.push({company_id:e,tag_id:s.id})}return await i.addCTTags(t)?{success:!0,payload:null,message:"successfully taged"}:{success:!1,payload:null,message:"can't put tags in"}},findDeveloper:async e=>{let s=await a.findDeveloper(e),t=[];for(let e of r(s)){const s=await n.findById(e[0]);t.push(s)}return{success:!0,payload:t,message:"successfully found"}}};e.exports=c},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),e.exports={post:(e,s)=>{s.clearCookie("token").status(200).send("ok")}}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{userService:n}=t(1);e.exports={post:a(async(e,s)=>{const t=e.body,a=await n.signup(t);if(!a.success)return"duplicated"===a.message?void s.status(409).send("User already exists"):void s.sendStatus(500);s.status(200).send("User successfully created!")})}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{userService:n}=t(1);e.exports={post:a(async(e,s)=>{const t=e.body.email;/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/.test(String(t).toLowerCase())||s.status(400).send("It is not email"),(await n.checkEmail(t)).success?s.status(200).send("This email is usable!"):s.status(400).send("This email has already joined")})}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{companyService:n}=t(1);e.exports={post:a(async(e,s)=>{const t=e.body,a=await n.signup(t);if(!a.success)return void s.status(409).send(a.message);const o=a.payload.id;s.status(200).send({company_id:o,message:"Company successfully created!"})})}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{tokenGenerator:n}=t(4),{companyService:o}=t(1);e.exports={post:a(async(e,s)=>{const{company_code:t,email:a,username:i,password:d}=e.body,r=a||i,u=await o.signin(t,r,d);if(!u.success)return void s.status(404).send(u.message);const c=await n({email:u.payload.email,password:u.payload.password,user_type:"company"});s.cookie("token",c).status(200).send({message:"Token generated"})})}},function(e,s,t){"use strict";e.exports={board:t(41),boardbyid:t(42),like:t(43),likebyid:t(44)}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{userService:n,postingService:o}=t(1);e.exports={post:a(async(e,s)=>{const t=e.body,{selected_tags:a}=t,{token:i}=e.cookies,d=await n.findByToken(i);if(!d.success)return void s.status(403).send("login required");t.user_id=d.payload.id;const r=await o.create(t);if(!r.success)return void s.status(404).send(r.message);const{id:u}=r.payload;(await o.addTags(u,a)).success||s.status(201).send({post_id:u,message:"it successfully created but can't put tags in\"}"}),s.status(201).send({post_id:u,message:"it successfully created!"})}),get:a(async(e,s)=>{const{id:t}=e.body,{token:a}=e.cookies,i=await o.find(t);if(!i.success)return void s.status(404).send("i can't find your postings");let d=i.payload;if(a){const e=await n.findByToken(a);if(!e.success)return void s.status(403).send("login required");const t=e.payload.id;d.isAuthor=d.user_id===t}s.status(200).send(d)}),put:a(async(e,s)=>{const t=e.body,{token:a}=e.cookies,i=await n.findByToken(a);if(!i.success)return void s.status(403).send("login required");const d=i.payload.id,r=await o.update(d,t);if(!r.success)return void s.status(404).send(r.message);const{id:u,selected_tags:c}=t,l=await o.addTags(u,c);l.success?s.status(201).send("Posting successfully updated!"):s.status(404).send(l.message)}),delete:a(async(e,s)=>{const{id:t}=e.body,{token:a}=e.cookies,i=await n.findByToken(a);if(!i.success)return void s.status(403).send("login required");const d=i.payload.id,r=await o.find(t);if(!r.success)return void s.status(404).send("i can't find your postings");if(r.payload.user_id!==d)return void s.status(403).send("It is not your posting");const u=await o.delete(t);u.success?s.status(200).send("successfully deleted"):s.status(404).send(u.message)}),test:a(async(e,s)=>{const{id:t}=e.body,a=await o.test(t);a.success?s.status(200).send(a):s.status(404).send("i can't find your postings")})}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{postingService:n,userService:o}=t(1);e.exports={get:a(async(e,s)=>{const t=e.params.id,{token:a}=e.cookies,i=await n.find(t);if(!i.success)return void s.status(404).send("i can't find your postings");let d=i.payload;if(a){const e=await o.findByToken(a);if(!e.success)return void s.status(403).send("login required");const t=e.payload.id;d.isAuthor=d.user_id===t}s.status(200).send(d)}),delete:a(async(e,s)=>{const t=e.params.id,{token:a}=e.cookies,i=await o.findByToken(a);if(!i.success)return void s.status(403).send("login required");const d=i.payload.id,r=await n.find(t);r.success?r.payload.user_id===d?(await n.delete(t)).success?s.status(200).send("successfully deleted"):s.status(404).send("There's an error while deleting your posting"):s.status(403).send("It is not your posting"):s.status(404).send("i can't find your postings")})}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{userService:n,postingService:o}=t(1);e.exports={post:a(async(e,s)=>{const{id:t}=e.body,{token:a}=e.cookies,i=await n.findByToken(a);if(!i.success)return void s.status(403).send("login required");const d=i.payload.id,r=await o.find(t);r.success?r.payload.user_id!==d?(await o.like(t)).success?s.status(200).send("successfully liked"):s.status(404).send("There's an error while liking"):s.status(403).send("You can't like yourself"):s.status(404).send("i can't find your postings")}),delete:a(async(e,s)=>{const{id:t}=e.body,{token:a}=e.cookies,i=await n.findByToken(a);if(!i.success)return void s.status(403).send("login required");const d=i.payload.id,r=await o.find(t);r.success?r.payload.user_id!==d?(await o.unlike(t)).success?s.status(200).send("successfully unliked"):s.status(404).send("There's an error while unliking"):s.status(403).send("You can't like yourself"):s.status(404).send("i can't find your postings")})}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{userService:n,postingService:o}=t(1);e.exports={post:a(async(e,s)=>{const t=e.params.id,{token:a}=e.cookies,i=await n.findByToken(a);if(!i.success)return void s.status(403).send("login required");const d=i.payload.id,r=await o.find(t);r.success?r.payload.user_id!==d?(await o.like(t)).success?s.status(200).send("successfully liked"):s.status(404).send("There's an error while liking"):s.status(403).send("You can't like yourself"):s.status(404).send("i can't find your postings")}),delete:a(async(e,s)=>{const t=e.params.id,{token:a}=e.cookies,i=await n.findByToken(a);if(!i.success)return void s.status(403).send("login required");const d=i.payload.id,r=await o.find(t);r.success?r.payload.user_id!==d?(await o.unlike(t)).success?s.status(200).send("successfully unliked"):s.status(404).send("There's an error while unliking"):s.status(403).send("can't like your posting"):s.status(404).send("i can't find your postings")})}},function(e,s,t){"use strict";e.exports={main:t(46)}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{userService:n,postingService:o}=t(1);e.exports={get:a(async(e,s)=>{const{token:t}=e.cookies,a=await n.findByToken(t);if(!a.success)return void s.status(403).send("login required");let i=a.payload,d=await o.findBlog(i.id);s.status(200).send(d.payload)})}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{userService:n,postingService:o}=t(1);e.exports={get:a(async(e,s)=>{const{token:t}=e.cookies,a=await n.findByToken(t);if(!a.success)return void s.status(403).send("login required");let i=a.payload;const d=await o.findBlog(i.id);if(!d.success)return void s.status(404).send(d.message);let r,u=0,c={};for(r of Object.values(d.payload))u+=r.length,r.map(e=>{0!==e.selected_tags.length&&e.selected_tags.map(e=>{c[e]=1})});c=Object.keys(c),i.post_count=u,i.tag_count=c.length,i.tags=c,s.status(200).send(i)}),put:a(async(e,s)=>{const t=e.body,{token:a}=e.cookies,o=await n.findByToken(a);if(!o.success)return void s.status(403).send("login required");let i=o.payload;if(t.email!==i.email)return void s.status(404).send("can't update email");const d=await n.update(t);d.success?s.status(200).send(d.payload):s.status(404).send(d.message)})}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{userService:n,companyService:o}=t(1);e.exports={get:a(async(e,s)=>{const{token:t}=e.cookies,a=await n.findByToken(t),i=await o.find(a.payload.company_id);if(!i.success)return void s.status(404).send("There's an error while finding your company");let d=i.payload;d.Users=d.Users.map(e=>(e.id===a.payload.id&&(e.dataValues.isUser=!0),e));const r=await o.findDeveloper(d.id);r.success?(d.recommended_developers=r.payload,s.status(200).send(d)):s.status(404).send("There's an error while finding developers")}),put:a(async(e,s)=>{const t=e.body,{company_tags:a}=t,{token:i}=e.cookies,d=await n.findByToken(i);if(!d.success)return void s.status(403).send("login required");if(d.payload.company_id!==t.id)return void s.status(403).send("you're not company user");const r=await o.update(t);if(!r.success)return void s.status(404).send(r.message);const u=t.id,c=await o.addTags(u,a);c.success?s.status(200).send("Company successfully updated"):s.status(404).send(c.message)}),member:t(49),memberbyid:t(50)}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{userService:n,companyService:o}=t(1);e.exports={put:a(async(e,s)=>{const{token:t}=e.cookies,a=e.body,i=await n.findByToken(t);if(!i.success)return void s.status(403).send("login required");const d=await o.find(i.payload.company_id);if(d.success)if(i.payload.company_id===d.payload.id){{const e=await n.updatebyId(a);if(!e.success)return void s.status(404).send(e.message)}s.status(200).send("Member successfully updated")}else s.status(404).send("it is not your company");else s.status(404).send("There's an error while finding your company")}),delete:a(async(e,s)=>{const{token:t}=e.cookies,{user_id:a}=e.body,i=await n.findByToken(t);if(!i.success)return void s.status(403).send("login required");const d=await o.find(i.payload.company_id);if(d.success)if(i.payload.company_id===d.payload.id){{const e=await n.delete(a);if(!e.success)return void s.status(404).send(e.message)}s.status(200).send("Member successfully deleted")}else s.status(404).send("it is not your company");else s.status(404).send("There's an error while finding your company")})}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{userService:n,companyService:o}=t(1);e.exports={delete:a(async(e,s)=>{const{token:t}=e.cookies,a=e.params.id,i=await n.findByToken(t);if(!i.success)return void s.status(403).send("login required");const d=await o.find(i.payload.company_id);if(d.success)if(i.payload.company_id===d.payload.id){{const e=await n.delete(a);if(!e.success)return void s.status(404).send(e.message)}s.status(200).send("Member successfully deleted")}else s.status(404).send("it is not your company");else s.status(404).send("There's an error while finding your company")})}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{tags:n}=t(5);e.exports={get:a(async(e,s)=>{const t=await n.getPTTags();t?s.status(200).send({tags:t.map(e=>e.name)}):s.status(404).send("There's an error while finding tags")})}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{postingService:n}=t(1);e.exports={get:a(async(e,s)=>{const t=await n.getHome();t.success?s.status(200).send(t.payload):s.status(404).send(t.message)})}},function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a=t(0),{isValid:n}=t(4),{userService:o}=t(1);e.exports={get:a(async(e,s)=>{const{token:t}=e.cookies;let a={token:!1};const o=await n(t);o.isValid&&(a.token=!0,a.join_type=o.userData.user_type),s.status(200).send(a)}),post:a(async(e,s)=>{const{token:t}=e.cookies;let a=null;const n=await o.findByToken(t);n.success&&(a=n.payload,delete a.password),a?s.status(200).send({userData:a}):s.status(200).send({isLogin:!1})})}}]));